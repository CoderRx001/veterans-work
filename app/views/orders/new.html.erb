<%= form_for @order do |f| %>
  Quantity: <%= f.number_field :quantity %><br />
  <%= f.submit %>
<% end %>

<div id="paypal-button"></div>

<script>
  var CREATE_PAYMENT_URL  = '/paypal/create-payment';
  var EXECUTE_PAYMENT_URL = '/paypal/execute-payment';

  paypal.Button.render({

    env: 'sandbox', // Or 'sandbox',

    commit: true, // Show a 'Pay Now' button

    payment: function() {
        // Set up the payment here
      return paypal.request.post(CREATE_PAYMENT_URL).then(function(data) {
        return data.id;
      });
    },
    onAuthorize: function(data, actions) {
        // Execute the payment here
      return paypal.request.post(EXECUTE_PAYMENT_URL, {
          paymentID: data.paymentID,
          payerID:   data.payerID
      }).then(function() {

          // The payment is complete!
          // You can now show a confirmation message to the customer
      });
    }
  }, '#paypal-button');
</script>
